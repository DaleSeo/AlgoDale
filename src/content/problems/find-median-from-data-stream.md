---
title: "Find Median from Data Stream"
tags:
  - leetcode
  - heap
  - math
  - python
date: 2024-07-18
---

LeetCodeì˜ 295ë²ˆì§¸ ë¬¸ì œì¸ [Find Median from Data Stream](https://leetcode.com/problems/find-median-from-data-stream/)ë¥¼ í•¨ê»˜ í’€ì–´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

## ë¬¸ì œ

ì¤‘ì•™ê°’(median)ì€ ì •ë ¬ëœ ì •ìˆ˜ ëª©ë¡ì—ì„œ ì¤‘ê°„ ê°’ìž…ë‹ˆë‹¤.
ëª©ë¡ì˜ í¬ê¸°ê°€ ì§ìˆ˜ì¸ ê²½ìš° ì¤‘ê°„ì— ê°’ì´ ì—†ìœ¼ë¯€ë¡œ ì¤‘ì•™ê°’ì€ ì¤‘ê°„ì— ìžˆëŠ” ë‘ ê°’ì˜ í‰ê· (mean)ì´ ë©ë‹ˆë‹¤.

- ì˜ˆë¥¼ ë“¤ì–´, `arr = [2,3,4]`ì˜ ê²½ìš° ì¤‘ì•™ê°’ì€ `3`ìž…ë‹ˆë‹¤.
- ì˜ˆë¥¼ ë“¤ì–´, `arr = [2,3]`ì˜ ê²½ìš° ì¤‘ì•™ê°’ì€ `(2 + 3) / 2 = 2.5`ìž…ë‹ˆë‹¤.

`MedianFinder` í´ëž˜ìŠ¤ë¥¼ êµ¬í˜„í•˜ì‹­ì‹œì˜¤:

- `MedianFinder()`ëŠ” `MedianFinder` ê°ì²´ë¥¼ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.
- `void addNum(int num)`ëŠ” ë°ì´í„° ìŠ¤íŠ¸ë¦¼ì—ì„œ ì •ìˆ˜ `num`ì„ ë°ì´í„° êµ¬ì¡°ì— ì¶”ê°€í•©ë‹ˆë‹¤.
- `double findMedian()`ì€ ì§€ê¸ˆê¹Œì§€ì˜ ëª¨ë“  ìš”ì†Œì˜ ì¤‘ì•™ê°’ì„ ë°˜í™˜í•©ë‹ˆë‹¤. ì‹¤ì œ ë‹µë³€ê³¼ `10^-5` ë‚´ì˜ ë‹µë³€ì´ í—ˆìš©ë©ë‹ˆë‹¤.

## ì˜ˆì œ

```py
ìž…ë ¥:
["MedianFinder", "addNum", "addNum", "findMedian", "addNum", "findMedian"]
[[], [1], [2], [], [3], []]
ì¶œë ¥:
[null, null, null, 1.5, null, 2.0]
```

## í’€ì´ 1: Array

ë¨¼ì € ì„±ëŠ¥ì„ ê³ ë ¤í•˜ì§€ ì•Šê³  ë‹¤ì†Œ ë¬´ì‹í•˜ê²Œ ë¬¸ì œë¥¼ í’€ì–´ë³¼ê¹Œìš”?

ì¤‘ì•™ê°’ì˜ ì •ì˜ì— ë”°ë¥´ë©´ ìš°ë¦¬ëŠ” ìˆ«ìžë“¤ì„ ì •ë ¬ëœ ìƒíƒœë¡œ ë³´ê´€í•´ì•¼ í•œë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìžˆìŠµë‹ˆë‹¤.
ìˆ«ìžê°€ í™€ìˆ˜ê°œ ìžˆë‹¤ë©´ ê·¸ ì¤‘ì— ì¤‘ê°„ì— ìžˆëŠ” í•œ ê°œì˜ ê°’ì´ ì¤‘ì•™ê°’ì´ê³ , ì§ìˆ˜ê°œ ìžˆë‹¤ë©´ ê·¸ ì¤‘ì— ì¤‘ê°„ì— ìžˆëŠ” ë‘ ê°œì˜ ê°’ì˜ í‰ê· ì„ ë‚´ë©´ ë©ë‹ˆë‹¤.

ë”°ë¼ì„œ ìš°ë¦¬ëŠ” ë‹¨ìˆœížˆ [ë°°ì—´(Array)](/data-structures/array/) í•˜ë‚˜ë¥¼ ì‚¬ìš©í•˜ì—¬ `MedianFinder` í´ëž˜ìŠ¤ë¥¼ êµ¬í˜„í•  ìˆ˜ ìžˆì„ ê²ƒìž…ë‹ˆë‹¤.

- `addNum()` ë©”ì„œë“œëŠ” ê·¸ ë°°ì—´ì— ìˆ«ìžë¥¼ ì¶”ê°€í•œ ë‹¤ìŒ, ë°°ì—´ì„ ì •ë ¬í•´ì¤ë‹ˆë‹¤.
- `findMedian()` ë©”ì„œë“œëŠ” ë°°ì—´ì˜ ê¸¸ì´ê°€ í™€ìˆ˜ì´ë©´ ì •ì¤‘ì•™ì— ìžˆëŠ” ìˆ«ìžì„ ë°˜í™˜í•˜ê³ , ì•„ë‹ˆë¼ë©´ ì¤‘ê°„ì— ìžˆëŠ” ë‘ ê°œì˜ ê°’ì˜ í‰ê· ì„ ë°˜í™˜í•©ë‹ˆë‹¤.

ì´ ì•Œê³ ë¦¬ì¦˜ì„ íŒŒì´ì¬ìœ¼ë¡œ êµ¬í˜„í•´ë³¼ê¹Œìš”?

```py
class MedianFinder:
    def __init__(self):
        self.nums = []

    def addNum(self, num: int) -> None:
        self.nums.append(num)
        self.nums.sort()

    def findMedian(self) -> float:
        if len(self.nums) & 1:
            return self.nums[len(self.nums) // 2]
        else:
            mid1 = self.nums[len(self.nums) // 2 - 1]
            mid2 = self.nums[len(self.nums) // 2]
            return (mid1 + mid2) / 2
```

ì´ ì½”ë“œëŠ” LeetCodeì—ì„œ ì£¼ì–´ì§„ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ëŠ” í†µê³¼ë¥¼ í•˜ì§€ë§Œ ì œì¶œì„ í•´ë³´ë©´ `Time Limit Exceeded` ì˜¤ë¥˜ê°€ ë°œìƒí•  ê²ë‹ˆë‹¤.
ê·¸ ì´ìœ ëŠ” `addNum()` ë©”ì„œë“œê°€ í˜¸ì¶œë  ë•Œë§ˆë‹¤ ì „ì²´ ë°°ì—´ì„ ì •ë ¬í•´ì•¼í•˜ê¸° ë•Œë¬¸ì— `O(n * log n)`ì˜ ì‹œê°„ì´ ê±¸ë¦¬ê¸° ë•Œë¬¸ìž…ë‹ˆë‹¤.

## í’€ì´ 2: Heap

ìˆ«ìžë“¤ì„ í•˜ë‚˜ì˜ ë°°ì—´ì— ëª¨ë‘ ì €ìž¥í•˜ì§€ ì•Šê³  ì´ë“±ë¶„í•˜ì—¬ ì €ìž¥í•´ë‘ë©´ ì–´ë–¨ê¹Œìš”?

ë§Œì•½ì— í™€ìˆ˜ê°œì˜ ìˆ«ìžê°€ ìžˆë‹¤ë©´, ì¤‘ì•™ê°’ì€ ì²« ë²ˆì§¸ ë°°ì—´ì—ì„œ ê°€ìž¥ í° ê°’ì´ê±°ë‚˜ ë‘ ë²ˆì§¸ ë°°ì—´ì˜ ê°€ìž¥ ìž‘ì€ ê°’ì´ ë  ê²ƒìž…ë‹ˆë‹¤.

```py
1, 2, 3 | 4, 5
      ðŸ‘†

1, 2 | 3, 4, 5
       ðŸ‘†
```

ë§Œì•½ì— ì§ìˆ˜ê°œì˜ ìˆ«ìžê°€ ìžˆë‹¤ë©´, ì¤‘ì•™ê°’ì€ ì²« ë²ˆì§¸ ë°°ì—´ì—ì„œ ê°€ìž¥ í° ê°’ê³¼ ë‘ ë²ˆì§¸ ë°°ì—´ì˜ ê°€ìž¥ ìž‘ì€ ê°’ì˜ í‰ê· ì´ ë  ê²ƒìž…ë‹ˆë‹¤.

```py
1, 2, 3 | 4, 5, 6
      ðŸ‘†  ðŸ‘†
```

í˜¹ì‹œ ì´ë ‡ê²Œ ìµœì†Œê°’ì´ë‚˜ ìµœëŒ€ê°’ì„ íš¨ê³¼ì ìœ¼ë¡œ ì°¾ëŠ”ë° ìµœì í™”ëœ ìžë£Œêµ¬ì¡°ê°€ ë– ì˜¤ë¥´ì‹œë‚˜ìš”?
ë„¤ ë§žìŠµë‹ˆë‹¤! ë°”ë¡œ [íž™(Heap)](/data-structures/heap/)ìž…ë‹ˆë‹¤. ðŸ‘

ìˆ«ìžë¥¼ ì¶”ê°€í•  ë•Œ ìž‘ì€ ê°’ë“¤ì€ ìµœëŒ€ íž™(max heap)ì— í° ê°’ë“¤ì€ ìµœì†Œ íž™(min heap)ì— ì €ìž¥í•˜ë©´ ë©ë‹ˆë‹¤.
ê·¸ë¦¬ê³  ë‘ íž™ì˜ ê°„ì˜ í¬ê¸° ì°¨ì´ê°€ í•­ìƒ `1`ì„ ë„˜ì–´ê°€ì§€ ì•Šë„ë¡ ê· í˜•ì„ ìœ ì§€ë¥¼ ì‹œì¼œì¤˜ì•¼ í•©ë‹ˆë‹¤.

ì´ë ‡ê²Œ í•´ì£¼ë©´ ìµœëŒ€ íž™ì—ì„œì˜ ìµœëŒ€ ê°’ê³¼ ìµœì†Œ íž™ì˜ ìµœì†Œê°’ìœ¼ë¡œ ì¤‘ì•™ê°’ì„ ì°¾ì„ ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

ë¬¸ì œì—ì„œ ì£¼ì–´ì§„ ì˜ˆì œì— ì´ ì•Œê³ ë¦¬ì¦˜ì„ ì ìš©í•´ë³¼ê¹Œìš”?

ë¨¼ì € ìˆ«ìž `1`ì€ í° ìˆ«ìžë“¤ì´ ì €ìž¥í•˜ê¸° ìœ„í•œ ìµœì†Œíž™ì— ì¶”ê°€í•˜ê² ìŠµë‹ˆë‹¤.
í° ì ˆë°˜ì—ì„œ ê°€ìž¥ ìž‘ì€ ê°’ì€ `1`ì´ ì¤‘ì•™ê°’ì´ ë©ë‹ˆë‹¤.

```py
addNum(1)

ìž‘ì€ ì ˆë°˜: []
í° ì ˆë°˜: [1]

ì¤‘ì•™ê°’: 1
```

ë‹¤ìŒ ìˆ«ìž `2`ì€ í° ì ˆë°˜ ê°€ìž¥ ìž‘ì€ `1`ë³´ë‹¤ í¬ë¯€ë¡œ í° ì ˆë°˜ì— ì¶”ê°€í•´ì•¼í•©ë‹ˆë‹¤.
ê·¸ëŸ°ë° ì´ëŸ¬ë©´ ìž‘ì€ ì ˆë°˜ì˜ í¬ê¸°ê°€ `0`ì´ê³  í° ì ˆë°˜ì˜ í¬ê¸°ê°€ `2`ê°€ ë˜ì„œ ê· í˜•ì´ ê¹¨ì§€ê²Œ ë©ë‹ˆë‹¤.
ë”°ë¼ì„œ í° ì ˆë°˜ì˜ ìµœì†Œê°’ì„ ì œê±°í•´ì„œ ìž‘ì€ ì ˆë°˜ì— ì¶”ê°€í•´ì£¼ê² ìŠµë‹ˆë‹¤.

ì´ì œ ë‘ ì ˆë°˜ì˜ í¬ê¸°ê°€ ê°™ìœ¼ë¯€ë¡œ ìˆ«ìžì˜ ê°œìˆ˜ê°€ ì§ìˆ˜ë¼ëŠ” ëœ»ìž…ë‹ˆë‹¤.
ë”°ë¼ì„œ ì¤‘ì•™ê°’ì€ ìž‘ì€ ì ˆë°˜ì˜ ìµœëŒ€ê°’ê³¼ í° ì ˆë°˜ ìµœì†Œê°’ì˜ í‰ê· ì´ ë©ë‹ˆë‹¤.

```py
addNum(2)

ìž‘ì€ ì ˆë°˜: [] => [1]
í° ì ˆë°˜: [1, 2] => [2]

ì¤‘ì•™ê°’: 1 + 2 / 2 = 1.5
```

ë§ˆì§€ë§‰ ìˆ«ìž `3`ì€ í° ì ˆë°˜ ê°€ìž¥ ìž‘ì€ `2`ë³´ë‹¤ í¬ë¯€ë¡œ í° ì ˆë°˜ì— ì¶”ê°€í•´ì•¼í•©ë‹ˆë‹¤.

ì´ë²ˆì—ëŠ” ë‘ ì ˆë°˜ì˜ í¬ê¸°ê°€ ë‹¤ë¥´ë¯€ë¡œ ìˆ«ìžì˜ ê°œìˆ˜ê°€ í™€ìˆ˜ë¼ëŠ” ëœ»ìž…ë‹ˆë‹¤.
ë”°ë¼ì„œ í° ì ˆë°˜ ìµœì†Œê°’ì´ ì¤‘ì•™ê°’ì´ ë©ë‹ˆë‹¤.

```py
addNum(3)

ìž‘ì€ ì ˆë°˜: [1]
í° ì ˆë°˜: [2, 3]

ì¤‘ì•™ê°’: 2
```

ì„¤ëª…ë“œë¦° ì•Œê³ ë¦¬ì¦˜ì„ íŒŒì´ì¬ì˜ `heapq` ëª¨ë“ˆì„ ì‚¬ìš©í•˜ì—¬ êµ¬í˜„í•´ë³´ê² ìŠµë‹ˆë‹¤.
ìµœì†Œ íž™ì— ìŒìˆ˜ë¥¼ ì¶”ê°€í•˜ê±°ë‚˜ ëºŒìœ¼ë¡œì¨ ìµœëŒ€ íž™ì˜ íš¨ê³¼ë¥¼ ë‚´ì—ˆìŠµë‹ˆë‹¤.

```py
from heapq import heappop, heappush

class MedianFinder:
    def __init__(self):
        self.lower = []  # max heap
        self.upper = []  # min heap

    def addNum(self, num: int) -> None:
        if not self.upper or self.upper[0] < num:
            heappush(self.upper, num)
        else:
            heappush(self.lower, -num)

        if len(self.lower) > len(self.upper):
            heappush(self.upper, -heappop(self.lower))
        elif len(self.lower) + 1 < len(self.upper):
            heappush(self.lower, -heappop(self.upper))

    def findMedian(self) -> float:
        if len(self.lower) < len(self.upper):
            return self.upper[0]
        else:
            return (-self.lower[0] + self.upper[0]) / 2
```

íž™ì— ì›ì†Œë¥¼ ì¶”ê°€í•˜ê±°ë‚˜ ì œê±°í•˜ëŠ”ë°ëŠ” `O(log n)`ì˜ ì‹œê°„ì´ ê±¸ë¦¬ê¸° ë•Œë¬¸ì— `addNum()` ë©”ì„œë“œì˜ ì‹œê°„ ë³µìž¡ë„ê°€ `O(log n)`ìœ¼ë¡œ í–¥ìƒì´ ë  ê²ƒìž…ë‹ˆë‹¤.

ë”°ë¼ì„œ ì´ ì½”ë“œëŠ” LeetCodeì—ì„œ ì œì¶œí•˜ë©´ ìž˜ í†µê³¼í•˜ëŠ” ê²ƒì„ ë³´ì‹¤ ìˆ˜ ìžˆìœ¼ì‹¤ ê±°ì—ìš”.
